generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id              Int         @id @default(autoincrement())
  nome_completo   String
  email           String      @unique
  cpf             String      @unique
  senha_hash      String
  role            Role        @default(USER)
  data_nascimento DateTime
  inscricoes      Inscricao[]
  criadoEm        DateTime    @default(now())
}

model Evento {
  id         Int         @id @default(autoincrement())
  titulo     String
  dataEvento DateTime
  local      String
  descricao  String?
  imagem_url String?
  banner_url String?
  organizador String?
  categorias Categoria[]
  inscricoes Inscricao[]
}

model Categoria {
  id       Int    @id @default(autoincrement())
  nome     String
  eventoId Int

  evento Evento @relation(fields: [eventoId], references: [id])
}

model Inscricao {
  id        Int    @id @default(autoincrement())
  status    String @default("PENDENTE")
  usuarioId Int
  eventoId  Int


  usuario Usuario @relation(fields: [usuarioId], references: [id])
  evento  Evento  @relation(fields: [eventoId], references: [id])
  pagamento  Pagamento?

  @@unique([usuarioId, eventoId])
}

model Pagamento {
  id           Int      @id @default(autoincrement())
  valor        Float
  status       String   @default("PENDENTE")
  metodo       String
  criadoEm     DateTime @default(now())

  inscricaoId Int      @unique
  inscricao   Inscricao @relation(fields: [inscricaoId], references: [id])
}

enum Role {
  USER
  ADMIN
}
